`r opts_chunk$set(cache=TRUE, fig.width=8)`
<link href="http://kevinburke.bitbucket.org/markdowncss/markdown.css" rel="stylesheet"></link>

plot_network Examples
========================================================
## Load phyloseq and the "enterotypes" dataset

```{r message=FALSE}
library(phyloseq); library(ggplot2)
data(enterotype)
```
For completeness, here is the version number of phyloseq used to build this instance of the tutorial -- and also how you can check your own current version from the command line.

```{r}
packageDescription("phyloseq")$Version
packageDescription("ggplot2")$Version
```

Create an igraph-based network based on the default distance method, "Jaccard", and a maximum distance between connected nodes of `0.3`.

```{r}
ig <- make_network(enterotype, max.dist=0.3)
```

# Use the plot_network function
Because we want to use the enterotype designations as a plot feature in these plots, we need to remove the 9 samples for which no enterotype designation was assigned (this will save us the hassle of some pesky warning messages, but everything still works; the offending samples are anyway omitted).

```{r}
enterotype = subset_samples(enterotype, !is.na(Enterotype))
```

Now plot this network representation with the default settings.

```{r}
plot_network(ig, enterotype)
```
The previous graphic displayed some interesting structure, with a major subgraph comprising a majority of samples. Furthermore, there seemed to be a correlation in the sample naming scheme and position within the network. Instead of trying to read all of the sample names to understand the pattern, let's map some of the sample variables onto this graphic as color and shape:

```{r}
plot_network(ig, enterotype, color="SeqTech", shape="Enterotype", line_weight=0.4, label=NULL)
```

In the previous examples, the choice of maximum-distance and distance method were informed, but arbitrary. Let's see what happens when the maximum distance is lowered, decreasing the number of edges in the network

```{r}
ig <- make_network(enterotype, max.dist=0.2)
plot_network(ig, enterotype, color="SeqTech", shape="Enterotype", line_weight=0.4, label=NULL)
```

Let's repeat the previous exercise, but replace the Jaccard (default) distance  method with Bray-Curtis

```{r}
ig <- make_network(enterotype, dist.fun="bray", max.dist=0.3)
plot_network(ig, enterotype, color="SeqTech", shape="Enterotype", line_weight=0.4, label=NULL)
```
			


---

### Other tutorial pages for the phyloseq package:

```{r other-graphics-links, results='asis', echo=FALSE}
htmlfiles = list.files(pattern="\\.html")
htmlstems = gsub(".html", "", htmlfiles)
mdlines = paste("#### [", htmlstems, "](", htmlfiles, ")", sep="")
cat(mdlines, sep="\n\n")
```

